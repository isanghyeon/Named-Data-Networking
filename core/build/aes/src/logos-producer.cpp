/* -*- Mode:C++; c-file-style:"gnu"; indent-tabs-mode:nil; -*- */
/*
 * Copyright (c) 2013-2022 Regents of the University of California.
 *
 * This file is part of ndn-cxx library (NDN C++ library with eXperimental eXtensions).
 *
 * ndn-cxx library is free software: you can redistribute it and/or modify it under the
 * terms of the GNU Lesser General Public License as published by the Free Software
 * Foundation, either version 3 of the License, or (at your option) any later version.
 *
 * ndn-cxx library is distributed in the hope that it will be useful, but WITHOUT ANY
 * WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A
 * PARTICULAR PURPOSE.  See the GNU Lesser General Public License for more details.
 *
 * You should have received copies of the GNU General Public License and GNU Lesser
 * General Public License along with ndn-cxx, e.g., in COPYING.md file.  If not, see
 * <http://www.gnu.org/licenses/>.
 *
 * See AUTHORS.md for complete list of ndn-cxx authors and contributors.
 */

//
// Created by 이상현 on 2022/11/07.
//

#include <ndn-cxx/face.hpp>
#include <ndn-cxx/security/key-chain.hpp>
#include <ndn-cxx/security/signing-helpers.hpp>

#include <iostream>

// Enclosing code in ndn simplifies coding (can also use `using namespace ndn`)
namespace ndn {
// Additional nested namespaces should be used to prevent/limit name conflicts
    namespace examples {

        class Producer
        {
        public:
            void
            run()
            {
                m_face.setInterestFilter(Name("/sch.ac.kr/calab/research.file", 0),
                                         std::bind(&Producer::onInterest, this, _1, _2),
                                         nullptr, // RegisterPrefixSuccessCallback is optional
                                         std::bind(&Producer::onRegisterFailed, this, _1, _2));

                auto cert = m_keyChain.getPib().getDefaultIdentity().getDefaultKey().getDefaultCertificate();
                m_certServeHandle = m_face.setInterestFilter(security::extractIdentityFromCertName(cert.getName()),
                                                             [this, cert] (auto&&...) {
                                                                 m_face.put(cert);
                                                             },
                                                             std::bind(&Producer::onRegisterFailed, this, _1, _2));
                m_face.processEvents();
            }

        private:
            void
            onInterest(const InterestFilter&, const Interest& interest)
            {
                std::cout << ">> I: " << interest << std::endl;

                static const std::string content("89504E47DA1AA000D49484452000CC00059860007289CB20001974455874536F667477617265041646F626520496D616765526561647971C9653C0038469545874584D4C3A636F6D2E61646F62652E786D70000003C3F787061636B657420626567696E3D22EFBBBF222069643D2257354D304D7043656869487A7265537A4E54637A6B633964223F3E203C783A786D706D65746120786D6C6E733A783D2261646F62653A6E733A6D6574612F2220783A786D70746B3D2241646F626520584D5020436F726520352E352D633032312037392E3135353737322C20323031342F30312F31332D31393A34343A30302020202020202020223E203C7264663A52444620786D6C6E733A7264663D22687474703A2F2F7777772E77332E6F72672F313939392F30322F32322D7264662D73796E7461782D6E7323223E203C7264663A4465736372697074696F6E207264663A61626F75743D222220786D6C6E733A786D704D4D3D22687474703A2F2F6E732E61646F62652E636F6D2F7861702F312E302F6D6D2F2220786D6C6E733A73745265663D22687474703A2F2F6E732E61646F62652E636F6D2F7861702F312E302F73547970652F5265736F75726365526566232220786D6C6E733A786D703D22687474703A2F2F6E732E61646F62652E636F6D2F7861702F312E302F2220786D704D4D3A4F726967696E616C446F63756D656E7449443D22786D702E6469643A35303537333963302D323030352D373934622D626362332D3363663164623161303261362220786D704D4D3A446F63756D656E7449443D22786D702E6469643A35424142334441423443393831314535394642453841463543383843333734382220786D704D4D3A496E7374616E636549443D22786D702E6969643A35424142334441413443393831314535394642453841463543383843333734382220786D703A43726561746F72546F6F6C3D2241646F62652050686F746F73686F702043432032303134202857696E646F777329223E203C786D704D4D3A4465726976656446726F6D2073745265663A696E7374616E636549443D22786D702E6969643A35303537333963302D323030352D373934622D626362332D336366316462316130326136222073745265663A646F63756D656E7449443D2261646F62653A646F6369643A70686F746F73686F703A34386465396263342D346339372D313165352D613762332D656133623239646539646464222F3E203C2F7264663A4465736372697074696F6E3E203C2F7264663A5244463E203C2F783A786D706D6574613E203C3F787061636B657420656E643D2272223F3E421FDA36001B3B4944415478DAEC5D97855D5B5DE818C2C1908119813024CA222429559B0C82038405B6D45A5A0885A5F7675B5F9FAD4F69D5A2E273401C41459588AC2A6A449031CA2C62321604284824A4EB3FF977B23939F7E6DEE46826FAFEF5B5FEE3DF79C3D9DF5AF69F92B292951962C59A8CEAD821B064C92C69225B184B962C602C59B280B164C92C69225B183B4962C59C058B264163C99258C254B1630962C59C058B26416387C09225B184B962C602C59B280B164C92C69225B184B962C60EC1058B264163C99258C254B1630962C59C058B264163C99258C1D24B962C602C59AA11AD71FF6ECD9A33EFEF863151F1FAFF4F1B1616161EAE8D1A3CE675C8B8A8A52274F9E54274E9C707E3E15A6161A1DF4AA2A3A39D7B5069E8B888870CAA85FBF7E595DAFBDF69A4A4D4D556DDAB451454545CE7DC78F1F577BF7EE459BA2E4962BE5DEC1723D5C9E5D2EF7BD3374E8D0638176F4E9A79F56B367CF56F5EAD53B6B5EEC6A76EDDBAEAF0E1C3AAB8B8F8AC6833DE27DE774C4C8C233BC78E1D2B9395334118BB891327AA499326851630F9F9F96AC386DAA65CB96E281CF353A78E735DFC439E79CE3BC388BF1E45C3B72E488DF4A1A3468E0345C3638A816CD4A89173DBC68D122959797E7945A0A0EE82822959D9D7DBE3CFF928CE451A5CD28689BB76EDBAF5C2B2F9C909898F85D201DCDCCCC74CACF77BAC0D635DFB3F031FEDA5F56E217C9E70238E3562A4B78A7F0415FF628CD0D765CB963963D0A74F1F151B1B5BF65E3C28927535178E138E103E17911CE11DE2BFC386AE8A7D89623F5047433451F810865518E37FB44CA0647CB76EDDAA76ECD8E128BF949414471FA21B4BD9D702BE17A6C37846E1FC72AAF3AEF5CA194A27E4166C2141919E9546026D7346074E55AF07583F43DFE1A8D7BF473F88C3A705D3675E13B586B5319FC8B1B376EBC403E269A87A6A38C837FF679EEB9E7964C9E3C79A458A06F2AEB68972E5DD483F3EE8683EA1578475380215CD9C297F1E55497F0E227A8F12EE83EB71CF7EE12F845F169E2F5CE4A5A93B75EAA4366FDEACA49FAA6BD7AE1570257CA9F0F5FCDB8AC257A12843B8BF16FE80F564217ADF2C3C9480977FD7E92E52E177E5EF8335C7CF8E187D543F3DA4264C98A01E79E4115F65C7ADFCEF6277B847283B97A0795DF8511BC3786856B86A26F0C5A2991688E024BAFFC38076FC58D4C7EE6996716E4E6E676EB2AA446A7D68CCC6C2CD5C16A7AA63F97B6180F71E16E3EC0A2EBBF52F81DE1CF85BB7595727E1F853F12BE911ADA97D6AA370E299ABD9B6A84ACA3F57F8FF8457B4FA64087FBE833807A83F0A7C26FB37DA0FD2954187F126EEF43E712D41B82B959BDFABD043EE251667215ABCC9AC155D3F18D8E8D4346D66CC989196939313C684A2BC1628C55058FE876E8549B0629B84D7AEFF6A8A72785EDEA0EBBA92C236C8E33758AA5DC2EB843750FB1FFB29FAD853FA19574CB72CF046E1F574F1DC34166D9338B19B566C1E497F15DE154D7F563C6387D4FD72C14EFE6CC1A6A68337C4462885E52CF2E18432DB2CEE1B7E1B3870E0FC6EDDBAA5C3AE997A14123966A0E97286C6112ECE18FA03C44C140BB2EA2361D4017E694BC8DD8E6195D43350782EC242D7F55CD6D595DAFB425A38B88450245793FC5D8495B1D2F8AA78BE8F6FF3292058B2F3852FE0E76B85B7BA5DD25B6EB925AD6DDBB66D10A77AD014FB0BCC731EACC714AE1F71BE842E69ED80C1A0468BE096B1FBBBAF6B95DD43189D66E108088D8422C486F196472C3AB671548FCFCA04183D2C68E1DFBC255575DF52BD160EF244FA9E33C1AF8E1D7B8AE21A01FE779EDA5247EB88E3FA6E0CFF488279FA38BE84B333FEBE14EC1925CCCBA3653539BA0DD2E3C8FED84A08EF613FC3FE1116C43D978BFC8482D9C739C2BD6921CB8393D8D8963367CE7CE6DC73CFF5AAE3A7AEEF481AFC52788761498E1288AFF0FE5FF91F999492B9BD94C11D869C2D04A71229C256EB83C0DCBC5659AA16F7209BE67A264CAC95EE85A71BF9E1E356AD449B12269722DE1143B2D601932648C022DBE293232729BC42F1345C6FA58469BA94C14D6BB86753A64C412260E36918BF24C62D6EBA8D6E8D3FBA959AF45257C2E037C2BFF5A199DBBBAEEDA565FB3650234E97CA8B742C1A42E19FBFFDB4F997847F26BC52B889BED8BF7FFFCB939393AF21A84CD7B599EBF93DFE32866F055AD34CDDBA7521F96922C0FDCDB998CA5CB3405C35AF67584767F93B2E2929E9B887CACE9F722C837FD660C18BDEC6EC59A10F03A71CDDE14E08C2EF36B434595959ADC5D2CC67F6ACA641739D4790B77EBD509E2D620FE91EBFA2F84FFE2D2E6D11EC2AC18347F1BA2BEDCEC71ED59C6439511ACE863C28F1BB2A45AB76E3DC959862576CA2337170C3D6A8B380CA5C32649D121212A0DDFA9FEEFF7B29EE55B4D41D8BF91A9DD2C6A4975896F9296974CB00446FBFFDB69A356B56615A5ADA75C5C5C5F3909276B967B034F3C53DEB5AC34D1FE9716D5610CFC33DFBD275AD89CBEA28A547FEBF25688FA11E79144C08B981D44196FA98A69F94B9861D3749C81BD3B61F23EDDD4B3730227411A2F5AF75A76F9195AA9F6B23A7171714E9D0CBD0A143E74BBC2CB92A1C1E2A8A8E262F5FDF7DF3B1391BB76ED2A144D365E2CCE3C5D9699A175E78618EB879AD6A68EC1A79F8FBC7DCFE7C0B4CCE3DA25AEEF5E69E7749715AAEA57A58CA4D1CFB40919C0AF3C921917BAAE79595FA4F73F645CD7B4363C674C95AAB735C1228297275A3F5B3E478430751C26D6AC60EFDEBD4DC59D8AD7B3B0A8FB3C4481D1B60D9C8A0D53B372CCF88452A14B08F9762DF90EF634CF76CC78E1D29CB972F7F60D8B061533CD2ABD525CCAA277A84D6690E578B98D6E6BD2CEE39ED21EC8B57F95B55F02B3BEF6B0541D5DDFE730F130DE4379C32D1C4797F44965AC20A88D8081692C36AC40AB56AD5649F0F6888E581EA6629F41C8B8F5C175EBD6DFCECB3CF9E6CDAB4A9312ED4EA14E1CBFB29659958145BB6D2FBEF822FCE5C2162D5A8C1F3162C42B6251AED12E255614AC5DBB76880E622A9FB8B108F5DBCC798E430B0E86B23DAE2556F25D7CBA122AFCC5C5615CAC9AB0EC1B9906B7DB8878F327386E4C9D2DAA98125571828EAFF9068F06A7CF10E279F3E6A9F5EBD7F7CCCDCD7D54CAAC8FD8C3468F3E6CD778D1C3972B63FB01C387040F5E8D1C3B1200447676B612F018C856251EE93407398B86DB17AB94D7E7EFEB95556DE5F7AF3C2CEEA90D72C7E5534A2D764455425DF7562B541413A2BE1CD709C8E31618277F2471FF72083B844F8CFC2F7A95A3279191E4C9C531542CC8120FD8B2FBE5019191997242727A7C5C4C43432C1A2292222A24841B82B0D3AB2CB86BEFBDF79E6AD7AE1DAC9F39AEDDBB73B80114B18DFAC59B3973558984C403A3B5FEE2B92CF912164C6180C25115E0B9CB3E1EA0907BD1686AF9222A40A470DF76B95BC742D49798015822664D63E6076ED721FF7DCC318E786B353055CD7CA985B17AA193366A8254B9660E2B16FAF5EBDE61F3972A491AF2C9C5CF7EBF6AD59B366963C75A215B863A6065C415358168E07A3A03A180D51175C7041BAB86C39F24C6188BB98EBC34D8BC325E4AF2B8E6EE6BD96A134BB0FC755E9CCBC26A480E7BBACC13E8FE79A54614CBC9ED91740DC8315E58F283A5455E4B9CAEE77D7FAD3559B250255640C0A1C4BD72262CA74E9DDA37353575BEB8466560F193BAF64D022BA5274DF5424DF99ED0B163C7562457AEB9434CAC636812E5DBAAC97988AB9D33E5FEA2107775B7876037B429035799C836D7772FF7B45BA0DE7025DF413B7C241E82958FD40FAE28BD298DC4DC92D73E64CF4C69EB58041CC1815E33334FBE2C58BD58013D4983163D4EAD5AB9D805E0D357FECE17816DA459D17E49307E29ACCBBE7DFBF47E16DA24A93F4D80D2DBDC2B826480074E34D37DDF4B7A8A8A8AF55C5F54EA120687D77DA15CB192E9B29CCB3CAEB913145E937AFD7C243AA42DF78588214723096F222F57725D1065C0B78801BF9B303D50A3F36A50B24B972E55E9E9E99EA1DB25E2597ECBBEFBE53EFBFFFBED2EEF18A0D9B871A36AD1A285BAF9E69B9D6B10641C96BBC499715629181372E90E7BBE7E5E535F38A67DC1D4127605DF4CECDC387F274859B01EBD4CABA5C1226D7842EA46F2606DD68C691E28F99FAD737CBEA77C060B5DCCB6A101C6346BFAD4B40AF57C6EC7A358757EA44E5D137533E81177A0B15282EBDA2AE12D5568F123F5825D037808C5BC88F37B837F5612673BFB904CE5CC2B693A02DCCAE5DBB9CEDC4D0F6D82189AC15183B3311A8081DFEBBBD28F1439CDE3886BF10F8CB2FBFFC9DD1A347BF2C21F9020C31543ECA237B049DC922060C35E995E657E9C94FB78D6079DC0CBC91A1CE3373DE2BF8E36327CFE1F2B8F798ABD6E9DE1384F78550EB3EEFC3DEA10C0B388DD7EEB76CDE59DBD508DF6ECB328150FB5C3280E5D5575F75413C1368417ACB7FE624B6A62622296D8A8A4A4A42B4488534DEDF93266099376AD4A8596235368B353852D93A3406CE5CA95E64ECC44F98CBD32A7805962525254583252348B054D52218EF95F8FEBCF41063602BE28F37CF5760FBB4AAB8812CB81DFB229EF14748E1CEF5281F7362717E9E43CA1B2B99934F31895F7D952EB232DB23C914C84C7E9C877B575843AE75CD64C9E086C1B202C6E53A51110356CD850711F447BB765E9DBB7EF876259B0847DEB962D5B32E5BE3AE6CA672F928157FBF7EF77E8410502472F9FFC56EB08865D92031CB135508B4EA15EC394ABBF9D97F8ED5F2EB80D4E84FD4A9CBD6E13A2C654AF4D55BA455827343A337335CEA3FC69AA74B9BB176182F3362C4D43270D3B01CE71FAA745FE82EC6243216B393F4EAAA29FC7AF9FEDDECD371C365431C8549C68B5DF1ED814993264DEEDFBF7F91C7F82DA2B88BB982FD353398A81B7B77CE733DBB545532917D461436147878FECDCB9D3B12C107A3D33EFEB19CC8DC01C8B4BB6139FCD9362B66FDF7E9198E958F9BE53AC46A44E425FE32640DE975F7EE9D429314BA258B253C0624F81B10B3C4C4C45452CA06B4A81D0601760501796C06317E10979B2E5F047FAF185CCA07550C68AAC3C2DD1640EC8374F0AFE83E9965D417FE9DF05DAA74EBAB08AA8CD839DCF11CCE2258E812586C6FFE8065EB39B2D6C26D3CB29A766CC983176EDDAB5EB87F1F5E21894AE534805C44ABB99B6E673CEB72CFE7E451F9A8DA49830B3F370B5727272DA89C0DE265A7EB768EE309C5C128C5C5C515894BD66CCF9E3D25E24685E9F2C452C43FFBECB34F75EAD4E97CB9E16AE431A0256666CC72CC1D13ADB550CAE8E968B945515B0847A33125EE815D4B6535DAE6EE34A82D5ED8C1516758D72CBA26B028EE858D11464876AF4FD6B6DBCF7AB88C6DC8BE8C98A4912C36ED6D6BF92FAC3328F37B261FD6D72AC0608D972A5D6E116B8785BB1853E06AF9D83DE73B3892B864980DDBB77979D3483727273731B8B75B9FB3F5B8AE4F8881556AD0A0C15EACB4373702CD3E79F7F8EEB4912FB2C102BD3D3DCA383CC991968D4C5F66A5932E89F7B3FC238C2E9EB64996374695EA6B518AE7CCFC91C21B85FA155391CE47B4B67C87ED537D06DF297623E4CC1C338FD33807E43E3632211B3EF53E872FA8A63B0CEF0335ABD595BC3BC6C1CFA518F19B5483FF7C1B57C4D7886AA455B94C38D580937BE9CA58A2601EB3E4E74C2C4FC2FD8FE9135FBE1871F94DEB3A28377B879AD5BB776B626E33BEE3FEFBCF3D6D0DF3FF9C9279F20C99024F7C3DF32CB7A1CBF42A805747BD8E29DA7213DDA48E8C31E26875A0903269217657B31E2CF379878CB3C2F4D95E8D54F96A835CBA59FF66C14ECEAE37F91E12AA5B2FC587A179C22D2AF06D67847BFA45BA627799B507945B0CDFB8961D2AB44B9942B18C427555F78896C7F14671881BAA7BE8584BC59B352256B8267F124241201A589A56AD5AAD17AB839BB6C1C28B874E9D22469C342B9BF8769DE196CE9D3BAF970BFAA60395D4ADFE95AAB847A426E860DD795A382DFE7E38F608DBF55A1DB2D7AFAD3CAD0F2228C6BC42A5CDAB66DDBC522ACC5B8E68B611134FBBA476F166BDCB8B1B339C20D1C2F90E03B164FC6C7C7AFBFE28A2BFE2AD7B6656666FEFBE1871F4E92DF16CA7D6560D1CB5D896276A39582CFD4829DCED46356CD83063D0A041C3F3F3F3BB1F3A74A8BB5C8B7578A9CC5577E23BE5BE5F07862D9B2653D2D3D347E8B4B48E733232329AF7E9D327AC79F3E6ABDE78E38DA4C4C4C485E28AF570EFEF37C09261C172AE11DFD99F1D0E767B01D70DBEE10D9C0846C7EB76EDDB0847F89F27F884665D498C976C63FEA19AED4392E416553AE15BC18D84421E3E7CF8C81B6FBCB1AF28EF7B95C789A4E15E6E1443136367615D8ABD6ACACACB09C9C9C121E2A1E969A9A5A52D971B1A09123473EF1CD37DF3C2560BC4DEFB444195256C2CC99331F1F3A74E8F1ECECECDB5103DCC391C66C3D6D1DAB6D608195BE84B1C2997231CE61A66DDD196C629C5B449623EEC64CF9E3D6F652C12C602298A5DBCE78AF29FB961E2C020CEFBB52A9D3BAB018783CBD85C68D1B8733D8EEAFD4C244A82C412ACABE1C9FD25819E2CF90840A68AD097C87353B5752D8F2F2F21ACF9933E72DB927CCB45CB42CEB264E9C18AB0D465F6AA8F2A3DDFF81FD48A89CC853188CC3C75EC167FAF25ED4D99EC0B8923EFD47AA742D19F6E5CFE320232D8BEDCBD0AEFA44CCCD2CB1DDCF59C67741B52B1DDD886436CCFEBD2FFD1D3A64D3B7FCD9A353B44F8E632264A61A76373364C84E2D67107E92E58D6620FD129319837FA907D68C0F62E56A76E41C03DFD18BBDC5F6E1DE21CC2862DB31B2976F30C3F613261022393EE87BD9F9D6E241D41519C95DB162C52312A36E35ACE0582642F0EDFE47B18CCE0FE6D824D6E45D66101F22E0FEA4CA779826716CE358EF67A4057704CDBF03DCDF63B0628E15CAE9CCC4C55C237B789CEF648E5604585182618328E74D2A31A0F7AF886BA5DD0FC9479DAB97D98499968E314B282DCB7314868B1D6ECFF2FE8363C4361C5796CEF51D8C13863388A20C1E4DDDF29F4CB292C7A2E29994069CE94F140BEB8751446D4F9319FEDC0B2F4C2C69F53A831F7E19C2A294A6884288BDCFBEFBFFFD1E4E4E4BF6B23CDE73013FE3327510C18E54F59DC2FFC5BEDC45217F955A55314335CD516806A3C1915A68B842732848681FD6854DE76F77B3BD5010539FA46BA5CF13A4E601E6EFCF8F110687D80794CBBD14D6F654D613F8FD328E675D2315DF914AA431D49AD9349CF73C86E38CCF3FA5C2C0982C62FF9F20FB22B41313A4C39849FC9B2A5F92748256ED318E17FAD6BF5A16A6AA649E918CD4AE845895CBBDDFC5DC72D04BD7AE5D1DB0444747EBF37CAB316BCA48914AABF19D7A3285857D25E84D1BB94423376BA32A3F52E91734E7D9FC3C999AE9256AEEC7A84D21647A8456F3552BF58A9B08AE5471B96F2F6A1453B588EFEE92D8AE73972E5DBE6DD9B265579782BB9EF583AF55E5731BFF24500D28B6831E6B19D8FB24DF7A64D820F45D68C1AEA5A238C976617E5EBD8661158BFE6F54C82B53B577B0FD7EB8FB85F817347E6B152BF61BDD28BCCD852D4F724EFFD8951EFADD922E7026CBFC3D411ECD711DC554BBBF45A9D1B49C77B3FE5DC6FD7518BB5C4B4F3637C3517F7A16312827D71CFA689BB5124EED85D3A9A0B7C882BF9D975D75DF73CC1B24E557F89BE3E8F38CBC34DCB56E5A7BD7C41B7EA4E82E92F8672C9E3BD407C3E52BCC951449A06BA5272373A97D13C1755BF7BA9C7FD023742C6E06589F9FE198FFF7055EE5AD461BD7B9F2838C5F74FDFAEC8522A3FC9755E9929AE96CCB22FBFFE43BA54517CD61C6BBD14269B2E5838DBAB5DA43C4387D1DF2AEADF0FAE715ACAE77355F91C913F97258142ACD7E6C1CD3C4F95AF99DB64F4DF5F3947A82031366974EF728D77718065D7615D31152CC84159388FCFF29FEA3329D4B14C631C2F240DD32FDCF94F09C9EF94F4949F94D9F3E7D3E59BD7AF51D29C56717171FB7AF4E8B1A25DBB768811B6D1BFCC57E966D7CE99854FC1756DF35A9167A5DF56DF3E4E415A64F8BDE7D2E73D87DAF0533E7F42952FEF584E53DE9F0E8415F7C95E1CE6CA6E5314F4431DB7095B8AF879F7CF2C9BB85DE52E5B3F845B45E5D28BC2DDFF3ACC878BBD44952FBF19EDF1FB6574777ECA765F46E5A2C7A23BFB348CF33C45EC735B2411FA0E2B13EF23885FC9CF382DE6BF94C8CCBF9ACAF1BDBD690F1992E5F19ED8A77B743F638B95B43EAF18EF30D010A3985634AADB1216B06E3DC68974D912952C8C01891F95BCB083FD2D73E7CE55AB56AD723687F99AD97B0B0DF54B57F4D216CCB3E87F8EE4F2C70C5D6AE5DEB3CBB83E73149B965CB96F787C19B250E295E6725F8CF8EE4725D8CD95CF878CCC5DB55CC1FDFBF71F92FAC6D1DC7F4A2D329A2E5786B94694CC732E4D8941F91D5D8B59AAFC1F134DA75B9345D7A73EB29A6ABF638DD36A434EFA0565D6DB89899EAD4F3C966C938F9C3E7DFA3B323E5F494870DCE2BA0662CA19F7E313DBE79A23546E667B361498F12982514C372D665BDE65BF33195BCCE5337D182B95D0FDD4631C0CEA4BFB75A287CFE1A27F81414149CC8CACADA28EEE471FE7633EF1B49F77A1AEB7E852ED4262AB33B188FDC49F07C4A8BAFC17FF41574CCBF97FEB64195AF9ED8E9C37D3FC0FB8AA9147D0584EB3756E4A3BBB4F9DBAD5BB77E2471E3EFE4FB658C6171CF34F9DEA12CE84E4B4BFB514F54F4EBD74FF7B58E30CE16A8A7FBEEC177A678871BD71E10CE136E207C8EC733F585A38DEFF578AFFE8EB2AE16EE2B3C42F84CBF46C8328ACA84E9D3A39B97A18DAEEF1EE17C619C8C13E3A7FD26E3D9CDC293FDDC136194A7FBD0A1A494AE34DAAFEFFF50F823A3FC53CAC37F1F3DD7BEFBDEE7A2285E385A3F8BDAEF17C94AB4FD78BF577B63386AA9A1C6DD4516FD3A64D8E1C18E4B515211AEF7E76C3329B330D8C7D2B163C7805CB29AA060D7AA543701BB1D85357A5FC2FE683B8155D18FB826AEB619E958AF1368DCB28B3CDC807E74412269951EF3D38EC2F6EDDBEB2D13FAF4FA1D461B2DD7DD88F16C7DF1E92754F9BAAD6346FB17ABF29D8FE658AC54E5DBB2A9CACDFA449136C2074FE7A64A7725C63A29F778FE9217FAF5485E6544C73CB102A8897E32CD7122B698E894E97ABB0D37DF0B8A5D34E61AA16FD7AFB39DEAD821F8D19358B58C254B1630962C59C058B264163C99258C254B962C602C59B280B164C92C69225B184B962C602C59B280B164C99258C254B1630962C59C058B264163C99258C254B1630962C59B280B164C92C69225B184B962C602C59B280B164E9FF29FD4780106B1A1D2F524C46F000049454E44AE426082");

                // Create Data packet
                auto data = make_shared<Data>(interest.getName());
                data->setFreshnessPeriod(10_s);
                data->setContent(make_span(reinterpret_cast<const uint8_t*>(content.data()), content.size()));

                // in order for the consumer application to be able to validate the packet, you need to setup
                // the following keys:
                // 1. Generate example trust anchor
                //
                //         ndnsec key-gen /example
                //         ndnsec cert-dump -i /example > example-trust-anchor.cert
                //
                // 2. Create a key for the producer and sign it with the example trust anchor
                //
                //         ndnsec key-gen /example/testApp
                //         ndnsec sign-req /example/testApp | ndnsec cert-gen -s /example -i example | ndnsec cert-install -

                // Sign Data packet with default identity
                m_keyChain.sign(*data);
                // m_keyChain.sign(*data, signingByIdentity(<identityName>));
                // m_keyChain.sign(*data, signingByKey(<keyName>));
                // m_keyChain.sign(*data, signingByCertificate(<certName>));
                // m_keyChain.sign(*data, signingWithSha256());

                // Return Data packet to the requester
                std::cout << "<< D: " << *data << std::endl;
                m_face.put(*data);
            }

            void
            onRegisterFailed(const Name& prefix, const std::string& reason)
            {
                std::cerr << "ERROR: Failed to register prefix '" << prefix
                          << "' with the local forwarder (" << reason << ")" << std::endl;
                m_face.shutdown();
            }

        private:
            Face m_face;
            KeyChain m_keyChain;
            ScopedRegisteredPrefixHandle m_certServeHandle;
        };

    } // namespace examples
} // namespace ndn

int
main(int argc, char** argv)
{
    try {
        ndn::examples::Producer producer;
        producer.run();
        return 0;
    }
    catch (const std::exception& e) {
        std::cerr << "ERROR: " << e.what() << std::endl;
        return 1;
    }
}